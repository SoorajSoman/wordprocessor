Canada's main stock index ended barely higher on Thursday, eking out a fresh all-time high for the third straight session as solid earnings from several mining stocks and a telecom company offset slips in oil and gold prices.n    The Toronto Stock Exchange's S&P/TSX composite indexn unofficially closed up 0.07 points at 15,394.45. nn (Reporting by Alastair Sharp; Editing by Meredith Mazzilli)